/* 
  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
  KreMLin invocation: /Users/danel/KreMLin/krml -I ../../../lib -tmpdir ../dist -warn-error @4@5@18+9 -fparentheses -skip-compilation -skip-makefiles -minimal -bundle FStar.*,LowStar.*,Prims -add-include "ESP_Types.h" -add-include "GPIO_Types.h" -add-include "Monotonic_VoidPointer.h" -verify Main.fst
  F* version: 4d3b33f6
  KreMLin version: c113d20b
 */

#include "Main.h"

GPIO_Constants_gpio_num_t Main_blink_gpio;

GPIO_Constants_gpio_num_t Main_button_gpio;

void Main_set_led_status(Monotonic_VoidPointer_t led_status)
{
  uint32_t *led = VoidPointer_UInt32_downcast(led_status);
  *led = (*led + (uint32_t)1U) & (uint32_t)1U;
}

void Main_main_task(Monotonic_VoidPointer_t led_status)
{
  GPIO_Constants_esp_err_t
  uu____0 = GPIO_gpio_set_level(Main_blink_gpio, *VoidPointer_UInt32_downcast(led_status));
  ESP_vTaskDelay((uint32_t)100U / ESP_portTICK_PERIOD_MS);
}

void Main_app_main()
{
  uint32_t led_status = (uint32_t)0U;
  GPIO_Constants_esp_err_t uu____0 = GPIO_gpio_pad_select_gpio(Main_blink_gpio);
  GPIO_Constants_esp_err_t
  uu____1 = GPIO_gpio_set_direction(Main_blink_gpio, GPIO_Constants_gpio_mode_output);
  GPIO_Constants_esp_err_t uu____2 = GPIO_gpio_pad_select_gpio(Main_button_gpio);
  GPIO_Constants_esp_err_t
  uu____3 = GPIO_gpio_set_direction(Main_button_gpio, GPIO_Constants_gpio_mode_input);
  GPIO_Constants_esp_err_t
  uu____4 = GPIO_gpio_install_isr_service(GPIO_Constants_esp_intr_flag_lowmed);
  GPIO_Constants_esp_err_t
  uu____5 =
    GPIO_gpio_isr_handler_add(Main_button_gpio,
      Main_set_led_status,
      VoidPointer_UInt32_upcast(&led_status));
  GPIO_Constants_esp_err_t
  uu____6 = GPIO_gpio_set_intr_type(Main_button_gpio, GPIO_Constants_gpio_intr_posedge);
  VoidPointer_While_while_true(Main_main_task, VoidPointer_UInt32_upcast(&led_status));
}

